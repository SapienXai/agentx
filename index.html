<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrowserX Agent</title>
    <link rel="icon" href="./logo.png" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <!-- Connect/QR Code Button -->
            <button id="connect-button" class="connect-btn" title="Connect a mobile device">
                <i class="bi bi-qr-code-scan"></i>
            </button>
            <img src="./agentx.gif" alt="BrowserX Logo" class="logo">
            <h1 class="brand-name">BrowserX</h1>
            <h2>What are we browsing next?</h2>
        </header>

        <!-- Action Box -->
        <section class="action-box">
            <textarea id="goal-input"
                      class="prompt-textarea"
                      rows="3"
                      aria-label="AI agent prompt"
                      placeholder="e.g., 'Scroll today's tech headlines and summarize the top 5 articles about AI.'"></textarea>
            <div class="action-buttons">
                <!-- Schedule button is decorative for now; functionality comes from prompt analysis -->
                <button class="schedule-btn" disabled>schedule</button>
                <button id="run-button" class="primary">Create & Run Agent</button>
            </div>
        </section>

        <!-- Tasks Section -->
        <main class="tasks-container">
            <nav class="tabs">
                <a href="#tasks" class="tab-link active" data-target="tasks-list">Tasks</a>
                <a href="#queue" class="tab-link" data-target="queue-list">Queue <span id="queue-count" class="task-count-badge"></span></a>
                <a href="#scheduled" class="tab-link" data-target="scheduled-tasks">Scheduled <span id="scheduled-count" class="task-count-badge"></span></a>
                <a href="#archived" class="tab-link" data-target="archived-tasks">Archive</a>
            </nav>

            <div id="task-lists-wrapper">
                <!-- Tasks List with its Empty State -->
                <div id="tasks-list" class="task-list">
                    <div class="empty-state-wrapper">
                        <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM8.5 12c.83 0 1.5-.67 1.5-1.5S9.33 9 8.5 9 7 9.67 7 10.5 7.67 12 8.5 12zm7 0c.83 0 1.5-.67 1.5-1.5S16.33 9 15.5 9s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-4.03 3.44c1.33.67 2.73.67 4.06 0 .23-.11.38-.34.35-.59-.03-.25-.23-.45-.48-.51-1.12-.28-2.3-.28-3.42 0-.25.06-.45.26-.48.51-.03.25.11.48.35.59z"/></svg>
                        <h3>Ready for my first mission!</h3>
                        <p class="text-muted">Create a task above or try one of these examples.</p>
                        <div class="example-tasks">
                            <div class="example-task-card" data-goal="Find the top 3 AI news headlines on Google News and summarize them.">
                                <h4>Summarize News</h4>
                                <p>Searches Google News for the latest on AI and provides a summary.</p>
                                <button class="example-run-btn">Try it</button>
                            </div>
                            <div class="example-task-card" data-goal="Go to ycombinator.com/jobs and find 3 remote software engineer jobs.">
                                <h4>Find Jobs</h4>
                                <p>Scans Y Combinator Jobs for remote software engineering roles.</p>
                                <button class="example-run-btn">Try it</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Queue List with its Empty State -->
                <div id="queue-list" class="task-list" style="display: none;">
                    <div class="empty-state-wrapper">
                        <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
                        <h3>The Queue is Empty</h3>
                        <p class="text-muted">When you run a task, it will appear here while waiting to execute. Tasks run one at a time to ensure focus.</p>
                    </div>
                </div>
                <!-- Scheduled List with its Empty State -->
                <div id="scheduled-tasks" class="task-list" style="display: none;">
                    <div class="empty-state-wrapper">
                        <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7v-5z"/></svg>
                        <h3>No Scheduled Tasks</h3>
                        <p class="text-muted">Create a recurring task by including a schedule in your goal, like "every morning at 8am".</p>
                        <div class="example-tasks">
                            <div class="example-task-card" data-goal="Check the top story on Hacker News every hour and summarize it.">
                                <h4>Hourly News Check</h4>
                                <p>Fetches and summarizes the top post on Hacker News every hour.</p>
                                <button class="example-run-btn">Try it</button>
                            </div>
                            <div class="example-task-card" data-goal="Find a new motivational quote and post it to my Twitter every morning at 9am.">
                                <h4>Daily Twitter Post</h4>
                                <p>Posts a fresh motivational quote to a connected account daily.</p>
                                <button class="example-run-btn">Try it</button>
                            </div>
                             <div class="example-task-card" data-goal="Check for new remote marketing jobs on LinkedIn every weekday at 5pm.">
                                <h4>Weekday Job Search</h4>
                                <p>Performs a job search on LinkedIn every weekday evening.</p>
                                <button class="example-run-btn">Try it</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Archived List with its Empty State -->
                <div id="archived-tasks" class="task-list" style="display: none;">
                    <div class="empty-state-wrapper">
                        <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM6.24 5h11.52l.83 1H5.42l.82-1zM5 19V8h14v11H5z"/></svg>
                        <h3>Archive is Empty</h3>
                        <p class="text-muted">Completed, stopped, or failed tasks can be archived here to keep your main list clean.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- QR Code Modal -->
    <div id="qr-modal" class="modal-overlay d-none">
        <div class="modal-content">
            <button id="close-modal-button" class="close-btn">×</button>
            <h3>Connect a Mobile Device</h3>
            <p class="text-muted">Scan the QR code below to open this control panel on another device.</p>
            <div class="qr-code-wrapper">
               <div class="spinner-border" role="status" id="qr-spinner">
                   <span class="visually-hidden">Loading...</span>
               </div>
               <img id="qr-code-image" src="" alt="QR Code" class="d-none">
            </div>
            <p class="mt-3">Or manually enter this URL:</p>
            <code id="connect-url">Loading...</code>
        </div>
    </div>

    <!-- Credentials Modal -->
    <div id="credentials-modal" class="modal-overlay d-none">
        <div class="modal-content">
            <button id="close-credentials-modal-button" class="close-btn">×</button>
            <h3>Agent Needs Credentials</h3>
            <p class="text-muted">The agent needs to log in to <strong id="credential-domain">...</strong> to continue.</p>
            <form id="credentials-form" class="credentials-form">
                <input type="text" id="username-input" placeholder="Username or Email" required>
                <input type="password" id="password-input" placeholder="Password" required>
                <button type="submit" class="primary">Save & Continue</button>
            </form>
        </div>
    </div>

    <!-- NEW: Toast Notification Container -->
    <div id="toast-container"></div>

    <script src="./progress.js"></script>
    <script src="./renderer.js"></script>
</body>
</html>